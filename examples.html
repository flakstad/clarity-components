<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Outline Component Examples</title>
  <style>
    /* Demo page styling */
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
    }

    /* Page theme variables */
    :root {
      /* Default dark theme for page */
      --bg-primary: #1e1e1e;
      --bg-secondary: #2d2d2d;
      --bg-tertiary: #333333;
      --text-primary: #f8f8f2;
      --text-secondary: #ddd;
      --text-muted: #888;
      --border: #555;
      --hover: rgba(255, 255, 255, 0.05);

      /* Web component will use its own defaults */
    }

    /* Light theme */
    @media (prefers-color-scheme: light) {
      :root {
        /* Light theme for page */
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fa;
        --bg-tertiary: #e9ecef;
        --text-primary: #212529;
        --text-secondary: #6c757d;
        --text-muted: #adb5bd;
        --border: #dee2e6;
        --hover: rgba(0, 0, 0, 0.05);

        /* Web component will use its own defaults */
      }
    }

    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .demo-section {
      margin-bottom: 4rem;
      padding: 2rem 0;
    }

    .demo-section h2 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.8rem;
      color: var(--text-primary);
    }

    .demo-section h3 {
      margin-top: 2rem;
      margin-bottom: 1rem;
      font-size: 1.2rem;
      color: var(--text-secondary);
    }

    .code-block {
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      overflow-x: auto;
      color: var(--text-primary);
    }

    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 0.5rem;
      color: var(--text-primary);
      cursor: pointer;
      font-family: inherit;
    }

    .theme-toggle:hover {
      background: var(--hover);
    }

    /* Custom theme examples removed - using component defaults */
  </style>
</head>
<body>

<div class="theme-toggle" onclick="toggleTheme()">
  ðŸŒ“ Toggle Theme
</div>

<div class="demo-container">


  <div class="demo-section">

    <clarity-outline
      id="empty-outline"
      data-assignees='["alice", "bob", "charlie"]'
      data-tags='["urgent", "bug", "feature", "docs"]'
      data-status-labels='[
        {"label": "TODO", "isEndState": false},
        {"label": "IN PROGRESS", "isEndState": false},
        {"label": "DONE", "isEndState": true}
      ]'>
    </clarity-outline>
  </div>

  <div class="demo-section">
  
    <clarity-outline
      id="sample-outline"
      data-items='[
        {
          "id": "1",
          "text": "Buy groceries",
          "status": "TODO"
        },
        {
          "id": "2",
          "text": "Do the thing that must be done",
          "status": "TODO",
          "priority": true
        },
        {
          "id": "3",
          "text": "Review pull request",
          "status": "DONE",
          "tags": ["urgent", "review"]
        },
        {
          "id": "4",
          "text": "Setup development environment",
          "status": "IN PROGRESS",
          "assign": "bob"
        },
        {
          "id": "5",
          "text": "Write documentation",
          "status": "TODO",
          "schedule": "Jan 5",
          "tags": ["docs", "feature"]
        },
        {
          "id": "6",
          "text": "Project Planning",
          "status": "none",
          "noLabel": true,
          "children": [
            {
              "id": "7",
              "text": "Define requirements",
              "status": "TODO",
              "schedule": "Jan 2"
            },
            {
              "id": "8",
              "text": "Create wireframes",
              "status": "TODO",
              "assign": "diana",
              "tags": ["design", "ui"]
            }
          ]
        },
        {
          "id": "9",
          "text": "Fix critical bug",
          "status": "TODO",
          "priority": true,
          "blocked": true,
          "tags": ["urgent", "bug"]
        },
        {
          "id": "10",
          "text": "Cancelled feature",
          "status": "CANCELLED",
          "assign": "diana",
          "tags": ["feature", "cancelled"]
        },
        {
          "id": "11",
          "text": "Read-only task (try editing this!)",
          "status": "TODO",
          "editable": false,
          "priority": true,
          "tags": ["readonly"]
        }
      ]'
      data-assignees='["alice", "bob", "charlie", "diana", "eve", "frank"]'
      data-tags='["urgent", "bug", "feature", "docs", "review", "ui", "backend", "testing", "readonly", "completed"]'
      data-status-labels='[
        {"label": "TODO", "isEndState": false},
        {"label": "IN PROGRESS", "isEndState": false},
        {"label": "DONE", "isEndState": true},
        {"label": "CANCELLED", "isEndState": true}
      ]'>
    </clarity-outline>
    
  </div>

  <!-- Rich Text Editor Demo -->
  <div class="demo-section">
    <div style="padding: 2rem; border: 1px solid var(--border); line-height: 1.8;">
      
      <p style="margin: 1rem 0; color: var(--text-primary);">
        This quarter we need to focus on several key initiatives. Here are the main tasks:
      </p>
      
      <clarity-outline id="rich-text-task-1" style="margin: 1rem 0;" 
        data-items='[{
          "id": "rt-1",
          "text": "Implement new user authentication system",
          "status": "TODO",
          "priority": "high",
          "due": "2024-01-15",
          "editable": false,
          "assign": "john@example.com"
        }]'
        data-features='{
          "addButton": false,
          "navigation": false,
          "reorder": false
        }'>
      </clarity-outline>
      
      <p style="margin: 1rem 0; color: var(--text-primary);">
        The backend infrastructure also needs attention. We should prioritize:
      </p>
      
      <clarity-outline id="rich-text-task-2" style="margin: 1rem 0;"
        data-items='[{
          "id": "rt-2",
          "text": "Optimize database queries for better performance",
          "status": "IN PROGRESS",
          "blocked": true,
          "assign": "sarah@example.com"
        }]'
        data-features='{
          "addButton": false,
          "navigation": false,
          "reorder": false
        }'>
      </clarity-outline>
      
      <p style="margin: 1rem 0; color: var(--text-primary);">
        Finally, for the user experience improvements:
      </p>
      
      <clarity-outline id="rich-text-task-3" style="margin: 1rem 0;"
        data-items='[{
          "id": "rt-3",
          "text": "Redesign the settings page with improved UX",
          "status": "TODO",
          "tags": ["ui", "ux", "frontend"]
        }]'
        data-features='{
          "addButton": false,
          "navigation": false,
          "reorder": false
        }'>
      </clarity-outline>
      
      <p style="margin: 1rem 0; color: var(--text-primary);">
        These embedded tasks maintain all their functionality - you can change status, set due dates, assign people, etc., 
        but without the navigation and reordering features that would be disruptive in a document context.
      </p>
    </div>
  </div>

</div>

<script src="outline.js"></script>
<script>
  // Theme toggle functionality
  let currentTheme = 'auto';

  function toggleTheme() {
    const themes = ['auto', 'light', 'dark'];
    const currentIndex = themes.indexOf(currentTheme);
    const nextIndex = (currentIndex + 1) % themes.length;
    currentTheme = themes[nextIndex];

    console.log('Switching to theme:', currentTheme);

    const root = document.documentElement;

    // Set theme attribute on all clarity-outline components
    const outlines = document.querySelectorAll('clarity-outline');
    outlines.forEach(outline => {
      outline.setAttribute('theme', currentTheme);
    });

    if (currentTheme === 'auto') {
      // Remove any forced theme and let CSS media queries handle it
      root.removeAttribute('data-theme');
      // Remove page theme properties
      const properties = [
        '--bg-primary', '--bg-secondary', '--bg-tertiary', '--text-primary', '--text-secondary', '--text-muted', '--border', '--hover'
      ];
      properties.forEach(prop => root.style.removeProperty(prop));
    } else if (currentTheme === 'light') {
      // Force light theme for page
      root.setAttribute('data-theme', 'light');
      root.style.setProperty('--bg-primary', '#ffffff');
      root.style.setProperty('--bg-secondary', '#f8f9fa');
      root.style.setProperty('--bg-tertiary', '#e9ecef');
      root.style.setProperty('--text-primary', '#212529');
      root.style.setProperty('--text-secondary', '#6c757d');
      root.style.setProperty('--text-muted', '#adb5bd');
      root.style.setProperty('--border', '#dee2e6');
      root.style.setProperty('--hover', 'rgba(0, 0, 0, 0.05)');
    } else if (currentTheme === 'dark') {
      // Force dark theme for page
      root.setAttribute('data-theme', 'dark');
      root.style.setProperty('--bg-primary', '#1e1e1e');
      root.style.setProperty('--bg-secondary', '#2d2d2d');
      root.style.setProperty('--bg-tertiary', '#333333');
      root.style.setProperty('--text-primary', '#f8f8f2');
      root.style.setProperty('--text-secondary', '#ddd');
      root.style.setProperty('--text-muted', '#888');
      root.style.setProperty('--border', '#555');
      root.style.setProperty('--hover', 'rgba(255, 255, 255, 0.05)');
    }

    // Update button text
    const button = document.querySelector('.theme-toggle');
    const icons = ['ðŸŒ“', 'â˜€ï¸', 'ðŸŒ™'];
    button.innerHTML = `${icons[nextIndex]} ${currentTheme.charAt(0).toUpperCase() + currentTheme.slice(1)} Theme`;
  }

  // Initialize all outline components
  const outlines = document.querySelectorAll('clarity-outline');

  outlines.forEach(outline => {
    // Log events for debugging
    const events = [
      'outline:add', 'outline:toggle', 'outline:move', 'outline:indent', 'outline:outdent',
      'outline:collapse', 'outline:expand', 'outline:edit:start', 'outline:edit:save',
      'outline:edit:cancel', 'outline:due', 'outline:assign', 'outline:tags',
              'outline:priority', 'outline:blocked', 'outline:open', 'outline:permission-denied'
    ];

    events.forEach(eventName => {
      outline.addEventListener(eventName, e => {
        console.log(`${outline.id}: ${eventName}`, e.detail);
      });
    });
  });

  // Add event listeners for the new comments and worklog features
  const newFeatureOutlines = document.querySelectorAll('clarity-outline');
  newFeatureOutlines.forEach(outline => {
    outline.addEventListener('outline:comment', e => {
      console.log('New comment added:', e.detail);
    });

    outline.addEventListener('outline:worklog', e => {
      console.log('New worklog entry added:', e.detail);
    });

    outline.addEventListener('outline:archive', e => {
      console.log('Item archived:', e.detail);
    });

    // Listen for permission denied events
    outline.addEventListener('outline:permission-denied', e => {
      console.log('Permission denied for item:', e.detail.id, 'action:', e.detail.action);
      // You could show a toast notification or other UI feedback here
    });
  });

  // The constrained outline demos now use <clarity-outline> web components
  // which initialize themselves automatically with the data-options attribute
</script>

</body>
</html>
